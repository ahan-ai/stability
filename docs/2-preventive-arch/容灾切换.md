容灾切换是应对重大灾难的机制。通常是通过在灾难后切换后热备上来恢复可用性。

容灾场景有非常多，例如：

- 单个机器故障
- 机柜发生故障
- 交换器发生故障
- 集群发生故障（通常是软件类故障）
- 机房发生故障
- 整体个 region 发生故障（通常是软件类故障）

对容灾方案影响比较大的是容灾的范围制定。例如对于单个机器、单个机柜，通常在设计上，就要把服务部署在不同的机柜、不同的机器上，在单个机器和单个机柜故障的场景下，系统可以在最快的时间内自愈。

而如果机房发生整体故障，这种情况比较少见，为了减少网络带来的干扰，机房级别的故障，通常会采取一些人为介入处理的方式，避免引起大范围的服务切换。

容灾推荐实践：如果服务 A 在某个范围 X 内提供服务，那么服务 A 的容灾需要基于 X - 1 级别的单元进行部署。

例如，我们的服务官网，是全球级别（X）的服务，全球任一位置都可以访问。X - 1 可以理解为 region 或机房，那么服务官网可以基于机房进行容灾，做到即使一个机房整体故障，服务也可以快速切换至其它的机房。

再例如，通常每个机房都有独立管控系统，用于管理机房内的基础设施。我们假设基础设施服务是机房级别的服务（X），该服务在整个机房内提供服务，只管理一个机房，不负责其它机房。X - 1可以理解为集群（根据场景也可以是别的范围），那么基础设施服务可以基于多个集群进行部署，并且在单个集群故障的情况下，可以切换至其它的集群。