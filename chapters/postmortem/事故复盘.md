*——让系统的伤疤，变成成长的纹理*

每个做运维、SRE、架构的团队，都逃不过一个瞬间：

当系统终于恢复，指挥群安静下来，大家的第一句话往往是——

“这次复盘什么时候开？”

复盘，是事故生命周期中最容易被忽略的一环。很多人把它当作事后报告，写完就归档。但真正成熟的团队知道：

**复盘不是结尾，而是进化的起点。**

一次好的复盘，不只是总结问题，而是让组织“变得更聪明”。

它的意义在于：

1. 理清“到底发生了什么”；
2. 找出“为什么会这样”；
3. 确定“下次如何更好”。

# 复盘前：为学习而准备，而不是为交差而准备

复盘的质量，从事故发生那一刻就开始决定。准备阶段的关键，是建立**事实基础**。

## 1. 留痕与记录机制

- 保留原始告警、监控、日志、时间线。
- 保留主要沟通记录（会议纪要、IM 群内关键节点）。
- 关键命令与操作要有唯一编号，避免“口头传达”。

这一阶段最常见的问题是：事后没人能准确还原现场。

**事实缺失，是所有复盘的毒药。**

## 2. 角色与职责明确

复盘不是自由讨论，而是有组织的学习。建议明确以下角色：

- **主持人**：保持中立，控制节奏，防止陷入无效争论；
- **技术负责人**：负责还原技术细节与关键决策背景；
- **记录人**：沉淀事实与结论，输出报告；
- **改进责任人**：对行动项闭环；
- **观察员（可选）**：其他团队成员，学习与借鉴。

## 3. 心态准备：复盘不是问责会

复盘不是追凶，而是追因。

如果复盘变成了“谁的锅”，团队只会学会**掩盖错误**。

真正的目标，是让系统和流程“少让人犯错”。

> 成熟的团队讨论“系统为什么没防住”，
> 
> 
> 幼稚的团队讨论“谁按了回车”。
> 

# 复盘中：重建时间线，找到系统性的根因

一次复盘会议的核心，是三个动作：**还原 → 分析 → 改进**。

## 1. 重建时间线（What Happened）

以分钟为粒度梳理事件流。

例如：

| 时间 | 事件 | 备注 |
| --- | --- | --- |
| 10:05 | 告警触发：Region A 访问延迟 > 3s | 系统自动报警 |
| 10:08 | SRE 登录 Grafana 确认延迟扩大 | 指标异常 |
| 10:15 | 发现 etcd leader 不稳定 | 触发 root cause |
| 10:40 | 暂停自动调度，延迟恢复 | 临时止血 |
| 11:20 | 原因确认：Region A 节点时钟漂移 | 根因锁定 |

时间线是复盘的骨架。**越清晰，争论越少。**

## 2. 追问“为什么”（Root Cause）

推荐使用 **5 Whys（五个为什么）** 原则：

1. 为什么服务崩溃？ → 因为 API Server 超时。
2. 为什么 API Server 超时？ → 因为 etcd 响应延迟高。
3. 为什么 etcd 延迟高？ → 因为 leader 频繁切换。
4. 为什么 leader 切换频繁？ → 因为节点时钟不同步。
5. 为什么时钟不同步？ → 因为 NTP 服务部署单点。

根因分析的价值，不是找到罪魁祸首，而是找到**系统改进的方向**。

## 3. 用鱼骨图（Fishbone Diagram）理清多维因果

可从以下六个维度分析：

- **人（People）**：是否有操作误判、沟通失误；
- **流程（Process）**：是否存在缺陷或审批缺失；
- **工具（Tools）**：监控、CI/CD、自动化是否缺位；
- **配置（Config）**：是否存在版本漂移、参数错误；
- **架构（Architecture）**：是否存在单点或依赖链过长；
- **外部因素（External）**：第三方、网络、电力等。

当事故复杂且交叉影响时，鱼骨图能帮助团队看清“相互作用的网”。

# 复盘后：让教训变成改进，而不是记忆

复盘的最后阶段，是**闭环与沉淀**。

## 1. 行动项（Action Items）闭环

每一条改进项都必须满足：

- 有明确责任人；
- 有完成时限；
- 有验证方式（监控指标或验收报告）。

建议每周例会追踪行动项进展，直到全部关闭。

## 2. 知识沉淀

事故经验应沉淀到统一的知识库（Wiki / Notion / GitBook），可搜索、可重用。

推荐使用「事故案例卡」格式，例如：

| 字段 | 示例 |
| --- | --- |
| 事故名称 | Region A 时钟漂移导致服务不可用 |
| 影响面 | 业务请求延迟 3000ms，持续 70 分钟 |
| 根因 | NTP 单点导致时间漂移 |
| 止血措施 | 临时手动同步时钟 |
| 永久修复 | NTP 高可用化 + 时钟漂移监控 |
| 教训总结 | 不可依赖单点同步机制 |

## 3. 周期性回顾

每季度或每半年回顾重大事故，评估改进项是否真正落地。

这是一种“系统免疫力”训练：不只是治病，而是提高抵抗力。

# 常见的复盘误区 🚫

| 误区 | 后果 | 正确做法 |
| --- | --- | --- |
| 把复盘当总结会 | 无实际改进 | 聚焦改进与机制 |
| 没有事实支撑 | 争论不休 | 从数据与日志出发 |
| 没有主持人 | 节奏混乱 | 设立中立主持 |
| 只改技术，不改流程 | 问题反复出现 | 技术+管理双修 |
| 行动项无人跟进 | 报告作废 | 建立跟踪机制 |

# 复盘会议模板 🗂️

以下是一份通用模板，可直接用于实际复盘会议记录或报告撰写：

### 《故障复盘报告模板》

**一、基本信息**

- 事故名称：
- 发生时间：
- 恢复时间：
- 持续时长：
- 影响范围（业务 / 用户 / 地域）：
- 负责人：
- 复盘主持人：

**二、时间线（Timeline）**

| 时间 | 事件 | 备注 |
| --- | --- | --- |
|  |  |  |

**三、影响分析**

- 受影响功能或产品：
- 用户侧表现：
- 监控数据摘要（关键指标变化）：

**四、根因分析（Root Cause Analysis）**

- 直接原因：
- 间接原因：
- 系统性原因：
- 防御机制失效点：

**五、处置过程与临时止血方案**

- 操作步骤：
- 恢复策略：
- 风险评估：

**六、永久修复方案与行动项（Action Plan）**

| 改进项 | 负责人 | 计划完成时间 | 验证方式 |
| --- | --- | --- | --- |
|  |  |  |  |

**七、经验与教训（Lessons Learned）**

- 哪些机制有效？
- 哪些地方需要重构？
- 可以复用的经验点？

**八、知识沉淀与传播**

- 案例编号：
- 是否纳入知识库：✅ / ❌
- 建议传播渠道：技术周会 / 内部分享 / 培训课

# 总结

复盘是让组织从一次事故中提炼智慧的过程。它不该是负担，而应该成为一种文化。真正成熟的团队不会害怕问题，而是害怕：

> “出了问题，却什么也没学到。”
> 

每一次复盘，都是组织智慧的一次积累。当你复盘到某天发——“我们的问题越来越小，复盘越来越短”——那就是系统变强的信号。 🚀